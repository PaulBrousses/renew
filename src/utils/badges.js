export const alcoholBadges = [
  // Premiers pas
  { id: 'alcohol_first_day', name: 'Premier jour', icon: '🌱', days: 1, color: 'bg-emerald-100 text-emerald-800', description: 'Le premier pas vers la liberté' },
  { id: 'alcohol_3_days', name: 'Détox', icon: '💧', days: 3, color: 'bg-blue-100 text-blue-800', description: 'Ton corps commence à se purifier' },
  { id: 'alcohol_week_1', name: 'Première semaine', icon: '🌿', days: 7, color: 'bg-green-100 text-green-800', description: 'Une semaine de clarté mentale' },
  { id: 'alcohol_2_weeks', name: 'Sommeil réparateur', icon: '😴', days: 14, color: 'bg-indigo-100 text-indigo-800', description: 'Ton sommeil s\'améliore' },
  { id: 'alcohol_3_weeks', name: 'Peau éclatante', icon: '✨', days: 21, color: 'bg-pink-100 text-pink-800', description: 'Ta peau retrouve son éclat' },
  
  // Premiers mois
  { id: 'alcohol_month_1', name: 'Foie en récupération', icon: '🫀', days: 30, color: 'bg-red-100 text-red-800', description: 'Ton foie commence à guérir' },
  { id: 'alcohol_6_weeks', name: 'Énergie retrouvée', icon: '⚡', days: 42, color: 'bg-yellow-100 text-yellow-800', description: 'Ton énergie est décuplée' },
  { id: 'alcohol_2_months', name: 'Mémoire améliorée', icon: '🧠', days: 60, color: 'bg-purple-100 text-purple-800', description: 'Ta mémoire s\'aiguise' },
  { id: 'alcohol_3_months', name: 'Système immunitaire', icon: '🛡️', days: 90, color: 'bg-cyan-100 text-cyan-800', description: 'Tes défenses se renforcent' },
  { id: 'alcohol_4_months', name: 'Pression artérielle', icon: '❤️', days: 120, color: 'bg-rose-100 text-rose-800', description: 'Ta tension se normalise' },
  
  // Transformations majeures
  { id: 'alcohol_6_months', name: 'Nouvelle personne', icon: '🦋', days: 180, color: 'bg-gradient-to-r from-purple-400 to-pink-400 text-white', description: 'Transformation complète' },
  { id: 'alcohol_9_months', name: 'Maître de soi', icon: '🧘', days: 270, color: 'bg-gradient-to-r from-green-400 to-blue-400 text-white', description: 'Contrôle total de tes émotions' },
  { id: 'alcohol_year_1', name: 'Légende', icon: '👑', days: 365, color: 'bg-gradient-to-r from-yellow-400 to-orange-400 text-white', description: 'Une année de victoire totale' },
  { id: 'alcohol_18_months', name: 'Inspiration', icon: '🌟', days: 547, color: 'bg-gradient-to-r from-indigo-400 to-purple-400 text-white', description: 'Tu inspires les autres' },
  { id: 'alcohol_2_years', name: 'Invincible', icon: '💎', days: 730, color: 'bg-gradient-to-r from-gray-700 to-gray-900 text-white', description: 'Rien ne peut t\'arrêter' },
  
  // Jalons spéciaux
  { id: 'alcohol_100_days', name: 'Centurion', icon: '💯', days: 100, color: 'bg-gradient-to-r from-red-400 to-pink-400 text-white', description: '100 jours de pure détermination' },
  { id: 'alcohol_200_days', name: 'Gladiateur', icon: '⚔️', days: 200, color: 'bg-gradient-to-r from-orange-400 to-red-400 text-white', description: 'Guerrier de la sobriété' },
  { id: 'alcohol_500_days', name: 'Titan', icon: '🏛️', days: 500, color: 'bg-gradient-to-r from-blue-600 to-purple-600 text-white', description: 'Force titanesque' },
  { id: 'alcohol_1000_days', name: 'Immortel', icon: '🔥', days: 1000, color: 'bg-gradient-to-r from-purple-600 to-pink-600 text-white', description: 'Légende immortelle' }
];

export const cigaretteBadges = [
  // Premiers pas
  { id: 'cigarette_first_day', name: 'Premier souffle', icon: '🌬️', days: 1, color: 'bg-sky-100 text-sky-800', description: 'Ton premier souffle de liberté' },
  { id: 'cigarette_3_days', name: 'Nicotine éliminée', icon: '🚫', days: 3, color: 'bg-red-100 text-red-800', description: 'La nicotine quitte ton corps' },
  { id: 'cigarette_week_1', name: 'Goût retrouvé', icon: '👅', days: 7, color: 'bg-orange-100 text-orange-800', description: 'Tes papilles se réveillent' },
  { id: 'cigarette_2_weeks', name: 'Circulation améliorée', icon: '🩸', days: 14, color: 'bg-red-100 text-red-800', description: 'Ton sang circule mieux' },
  { id: 'cigarette_3_weeks', name: 'Odorat affiné', icon: '👃', days: 21, color: 'bg-green-100 text-green-800', description: 'Tu redécouvres les odeurs' },
  
  // Premiers mois
  { id: 'cigarette_month_1', name: 'Poumons en guérison', icon: '🫁', days: 30, color: 'bg-blue-100 text-blue-800', description: 'Tes poumons commencent à guérir' },
  { id: 'cigarette_6_weeks', name: 'Endurance boostée', icon: '🏃', days: 42, color: 'bg-green-100 text-green-800', description: 'Tu cours sans t\'essouffler' },
  { id: 'cigarette_2_months', name: 'Toux disparue', icon: '🤐', days: 60, color: 'bg-emerald-100 text-emerald-800', description: 'Fini la toux du fumeur' },
  { id: 'cigarette_3_months', name: 'Capacité pulmonaire', icon: '💨', days: 90, color: 'bg-cyan-100 text-cyan-800', description: 'Tes poumons retrouvent leur force' },
  { id: 'cigarette_6_months', name: 'Risque cardiaque réduit', icon: '💗', days: 180, color: 'bg-pink-100 text-pink-800', description: 'Ton cœur te remercie' },
  
  // Transformations majeures
  { id: 'cigarette_year_1', name: 'Poumons neufs', icon: '🌪️', days: 365, color: 'bg-gradient-to-r from-blue-400 to-cyan-400 text-white', description: 'Tes poumons sont comme neufs' },
  { id: 'cigarette_18_months', name: 'Souffle de dragon', icon: '🐉', days: 547, color: 'bg-gradient-to-r from-red-400 to-orange-400 text-white', description: 'Souffle puissant et pur' },
  { id: 'cigarette_2_years', name: 'Maître du souffle', icon: '🌊', days: 730, color: 'bg-gradient-to-r from-teal-400 to-blue-400 text-white', description: 'Respiration parfaite' },
  { id: 'cigarette_5_years', name: 'Risque zéro', icon: '🛡️', days: 1825, color: 'bg-gradient-to-r from-green-500 to-emerald-500 text-white', description: 'Risque de cancer divisé par 2' },
  
  // Jalons spéciaux
  { id: 'cigarette_100_days', name: 'Air pur', icon: '🌿', days: 100, color: 'bg-gradient-to-r from-green-400 to-teal-400 text-white', description: '100 jours d\'air pur' },
  { id: 'cigarette_200_days', name: 'Guerrier du souffle', icon: '⚡', days: 200, color: 'bg-gradient-to-r from-yellow-400 to-orange-400 text-white', description: 'Champion de la respiration' },
  { id: 'cigarette_500_days', name: 'Tempête', icon: '🌪️', days: 500, color: 'bg-gradient-to-r from-gray-400 to-blue-400 text-white', description: 'Force de la nature' },
  { id: 'cigarette_1000_days', name: 'Éternel', icon: '♾️', days: 1000, color: 'bg-gradient-to-r from-indigo-500 to-purple-500 text-white', description: 'Souffle éternel' }
];

export const badges = [...alcoholBadges, ...cigaretteBadges];

export const getUnlockedBadges = (currentStreaks, addictions) => {
  const unlockedBadges = [];
  
  // Vérification de sécurité
  if (!addictions || !Array.isArray(addictions) || !currentStreaks) {
    return unlockedBadges;
  }
  
  addictions.forEach(addiction => {
    const streak = currentStreaks[addiction] || 0;
    const relevantBadges = addiction === 'alcohol' ? alcoholBadges : cigaretteBadges;
    const unlocked = relevantBadges.filter(badge => streak >= badge.days);
    unlockedBadges.push(...unlocked);
  });
  
  return unlockedBadges.sort((a, b) => a.days - b.days);
};

export const getNextBadge = (currentStreaks, addictions) => {
  const nextBadges = [];
  
  // Vérification de sécurité
  if (!addictions || !Array.isArray(addictions) || !currentStreaks) {
    return null;
  }
  
  addictions.forEach(addiction => {
    const streak = currentStreaks[addiction] || 0;
    const relevantBadges = addiction === 'alcohol' ? alcoholBadges : cigaretteBadges;
    const next = relevantBadges.find(badge => streak < badge.days);
    if (next) {
      nextBadges.push({ ...next, addiction });
    }
  });
  
  return nextBadges.sort((a, b) => a.days - b.days)[0];
};

export const getNewlyUnlockedBadges = (oldStreaks, newStreaks, addictions) => {
  const newBadges = [];
  
  // Vérification de sécurité
  if (!addictions || !Array.isArray(addictions) || !oldStreaks || !newStreaks) {
    return newBadges;
  }
  
  addictions.forEach(addiction => {
    const oldStreak = oldStreaks[addiction] || 0;
    const newStreak = newStreaks[addiction] || 0;
    
    if (newStreak > oldStreak) {
      const relevantBadges = addiction === 'alcohol' ? alcoholBadges : cigaretteBadges;
      const newlyUnlocked = relevantBadges.filter(badge => 
        newStreak >= badge.days && oldStreak < badge.days
      );
      newBadges.push(...newlyUnlocked.map(badge => ({ ...badge, addiction })));
    }
  });
  
  return newBadges;
};